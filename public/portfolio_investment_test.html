<!doctype html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ë‚´ í¬íŠ¸í´ë¦¬ì˜¤ë¡œ ë³´ëŠ” íˆ¬ì ì„±í–¥ í…ŒìŠ¤íŠ¸</title>
  <meta name="description" content="8ê°œ ì§ˆë¬¸ + ì‹¤ì œ í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ ì…ë ¥í•˜ë©´ í¬íŠ¸í´ë¦¬ì˜¤ ê±´ê°•ì ìˆ˜(0-100)ì™€ 8ê°€ì§€ íˆ¬ì ìœ í˜•ì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.">
  <style>
    @import url("https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css");

    :root {
      --bg: #faf7f2;
      --surface: #fffdf8;
      --ink: #1e2622;
      --muted: #6a6058;
      --line: #ddd5c9;
      --accent: #e8721c;
      --accent-light: #fff2e6;
      --accent-hover: #cf6518;
      --accent-2: #cf7a2a;
      --accent-3: #7a4510;
      --shadow: 0 18px 36px rgba(80, 40, 10, 0.10);
      --green: #2d9a5c;
      --yellow: #d4a017;
      --red: #c0392b;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: "Pretendard", "Apple SD Gothic Neo", sans-serif;
      color: var(--ink);
      background:
        radial-gradient(circle at 12% 10%, #fde4c8 0%, transparent 24%),
        radial-gradient(circle at 87% 0%, #fcebd6 0%, transparent 26%),
        linear-gradient(130deg, #faf7f2 0%, #f8f3ec 45%, #faf7f2 100%);
      min-height: 100vh;
    }

    .wrap {
      width: min(860px, 92vw);
      margin: 36px auto 56px;
    }

    /* â”€â”€ Hero â”€â”€ */
    .hero {
      background: linear-gradient(145deg, #d4650f, #e8841c);
      color: #fff;
      border-radius: 28px;
      padding: 30px 30px 26px;
      box-shadow: var(--shadow);
      position: relative;
      overflow: hidden;
      animation: fadeUp 0.7s ease both;
    }

    .hero::after {
      content: "";
      position: absolute;
      right: -45px;
      top: -35px;
      width: 180px;
      height: 180px;
      background: linear-gradient(165deg, rgba(255, 220, 160, 0.35), rgba(255, 220, 160, 0));
      border-radius: 50%;
    }

    .eyebrow {
      font-size: 13px;
      letter-spacing: 0.08em;
      opacity: 0.84;
      margin: 0 0 8px;
    }

    h1 {
      margin: 0;
      font-family: "Pretendard", sans-serif;
      font-size: clamp(30px, 4.2vw, 42px);
      line-height: 1.24;
      font-weight: 800;
    }

    .hero p {
      margin: 12px 0 0;
      font-size: 15px;
      opacity: 0.92;
      line-height: 1.6;
    }

    /* â”€â”€ Card â”€â”€ */
    .card {
      margin-top: 18px;
      border: 1px solid var(--line);
      background: var(--surface);
      border-radius: 24px;
      padding: 28px;
      box-shadow: 0 10px 26px rgba(80, 40, 10, 0.06);
      animation: fadeUp 0.7s ease 0.08s both;
    }

    /* â”€â”€ Quiz â”€â”€ */
    .top-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      margin-bottom: 15px;
    }

    .q-count {
      font-weight: 700;
      font-size: 14px;
      color: var(--accent-3);
    }

    .progress {
      width: 210px;
      height: 8px;
      background: #efe6da;
      border-radius: 999px;
      overflow: hidden;
    }

    .progress>span {
      display: block;
      width: 0%;
      height: 100%;
      border-radius: inherit;
      background: linear-gradient(90deg, var(--accent), #f5922e);
      transition: width 260ms ease;
    }

    .question {
      margin: 0 0 18px;
      font-size: clamp(21px, 3vw, 28px);
      line-height: 1.45;
      letter-spacing: -0.02em;
      font-family: "Pretendard", sans-serif;
      font-weight: 800;
    }

    .options {
      display: grid;
      gap: 10px;
    }

    .option {
      width: 100%;
      border: 1px solid var(--line);
      border-radius: 16px;
      background: #fff;
      padding: 15px 16px;
      text-align: left;
      font-size: 15px;
      color: #3a2e22;
      cursor: pointer;
      transition: transform 140ms ease, border-color 140ms ease, background 140ms ease;
      font-family: "Pretendard", sans-serif;
    }

    .option:hover {
      transform: translateY(-1px);
      border-color: #e0a060;
      background: #fff8f0;
    }

    /* â”€â”€ Portfolio Input â”€â”€ */
    .portfolio-section {
      display: none;
      animation: fadeUp 0.5s ease both;
    }

    .portfolio-section h2 {
      font-family: "Pretendard", sans-serif;
      font-weight: 800;
      font-size: clamp(22px, 3vw, 28px);
      margin-bottom: 6px;
    }

    .sub-desc {
      color: var(--muted);
      font-size: 14px;
      margin-bottom: 20px;
      line-height: 1.6;
    }

    .holding-row {
      display: grid;
      grid-template-columns: 1fr 1fr 40px;
      gap: 10px;
      margin-bottom: 10px;
      align-items: center;
    }

    .holding-row input,
    .extra-input input {
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 12px 14px;
      font-size: 15px;
      font-family: "Pretendard", sans-serif;
      background: #fff;
      color: var(--ink);
      transition: border-color 160ms ease;
      width: 100%;
    }

    .holding-row input:focus,
    .extra-input input:focus {
      outline: none;
      border-color: var(--accent);
    }

    .holding-row input::placeholder,
    .extra-input input::placeholder {
      color: #b8a89a;
    }

    .remove-btn {
      width: 36px;
      height: 36px;
      border: 1px solid #e0d6cc;
      border-radius: 10px;
      background: #fff;
      color: #a0887a;
      cursor: pointer;
      font-size: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 140ms ease, color 140ms ease;
    }

    .remove-btn:hover {
      background: #fff0e6;
      color: var(--accent);
    }

    /* â”€â”€ Extra inputs (cash + trading) â”€â”€ */
    .extra-section {
      margin-top: 24px;
      padding-top: 20px;
      border-top: 1px solid var(--line);
    }

    .extra-section h3 {
      font-size: 16px;
      font-weight: 700;
      color: var(--accent-3);
      margin-bottom: 14px;
    }

    .extra-input {
      margin-bottom: 16px;
    }

    .extra-input label {
      display: block;
      font-size: 14px;
      font-weight: 600;
      color: var(--ink);
      margin-bottom: 8px;
    }

    .radio-group {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }

    .radio-option {
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 12px 14px;
      text-align: center;
      font-size: 14px;
      color: #3a2e22;
      cursor: pointer;
      transition: all 160ms ease;
      background: #fff;
      font-family: "Pretendard", sans-serif;
    }

    .radio-option:hover {
      border-color: #e0a060;
      background: #fff8f0;
    }

    .radio-option.selected {
      border-color: var(--accent);
      background: var(--accent-light);
      color: var(--accent);
      font-weight: 700;
    }

    .radio-option input {
      display: none;
    }

    .portfolio-actions {
      display: flex;
      gap: 10px;
      margin-top: 20px;
      flex-wrap: wrap;
    }

    /* â”€â”€ Buttons â”€â”€ */
    .btn {
      border: 0;
      border-radius: 12px;
      padding: 12px 20px;
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      font-family: "Pretendard", sans-serif;
      transition: transform 100ms ease, opacity 100ms ease;
    }

    .btn:active {
      transform: scale(0.97);
    }

    .btn.primary {
      background: var(--accent);
      color: #fff;
    }

    .btn.primary:hover {
      background: var(--accent-hover);
    }

    .btn.secondary {
      background: #f0e8de;
      color: #4a3520;
    }

    .btn.secondary:hover {
      background: #e8ddd0;
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* â”€â”€ Loading â”€â”€ */
    .loading-overlay {
      display: none;
      text-align: center;
      padding: 60px 20px;
      animation: fadeUp 0.4s ease both;
    }

    .spinner {
      width: 48px;
      height: 48px;
      border: 4px solid #f0e6da;
      border-top-color: var(--accent);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin: 0 auto 20px;
    }

    .loading-overlay p {
      color: var(--muted);
      font-size: 15px;
      line-height: 1.6;
    }

    /* â”€â”€ Result â”€â”€ */
    .result {
      display: none;
      animation: fadeUp 0.5s ease both;
    }

    /* Score Gauge */
    .score-hero {
      text-align: center;
      padding: 28px 0 20px;
      border-bottom: 1px solid var(--line);
      margin-bottom: 24px;
    }

    .score-hero .label {
      font-size: 13px;
      font-weight: 600;
      color: var(--muted);
      letter-spacing: 0.04em;
      margin-bottom: 4px;
    }

    .gauge-wrap {
      position: relative;
      width: 160px;
      height: 160px;
      margin: 0 auto 12px;
    }

    .gauge-wrap svg {
      transform: rotate(-90deg);
    }

    .gauge-bg {
      fill: none;
      stroke: #f0e6da;
      stroke-width: 10;
    }

    .gauge-fill {
      fill: none;
      stroke: var(--accent);
      stroke-width: 10;
      stroke-linecap: round;
      stroke-dasharray: 440;
      stroke-dashoffset: 440;
      transition: stroke-dashoffset 1.2s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .gauge-text {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 42px;
      font-weight: 800;
      color: var(--ink);
      font-family: "Pretendard", sans-serif;
    }

    .gauge-text span {
      font-size: 18px;
      font-weight: 600;
      color: var(--muted);
    }

    .score-grade {
      font-size: 14px;
      color: var(--muted);
      margin-top: 4px;
    }

    /* Type Card */
    .type-card {
      background: linear-gradient(135deg, #d4650f, #e8841c);
      color: #fff;
      border-radius: 20px;
      padding: 24px;
      margin-bottom: 24px;
      position: relative;
      overflow: hidden;
    }

    .type-card::after {
      content: "";
      position: absolute;
      right: -30px;
      top: -20px;
      width: 120px;
      height: 120px;
      background: radial-gradient(circle, rgba(255, 220, 160, 0.3), transparent 70%);
      border-radius: 50%;
    }

    .type-card .type-label {
      font-size: 12px;
      opacity: 0.8;
      letter-spacing: 0.06em;
      margin-bottom: 6px;
    }

    .type-card .type-name {
      font-family: "Pretendard", sans-serif;
      font-weight: 800;
      font-size: clamp(24px, 3.5vw, 32px);
      margin-bottom: 10px;
    }

    .type-card .type-oneliner {
      font-size: 15px;
      opacity: 0.92;
      line-height: 1.6;
      margin-bottom: 14px;
    }

    .type-tags {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .type-tag {
      padding: 5px 12px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 600;
    }

    .type-tag.strength {
      background: rgba(255, 255, 255, 0.18);
      color: #c8e6c9;
    }

    .type-tag.caution {
      background: rgba(255, 255, 255, 0.12);
      color: #ffe0b2;
    }

    /* Score Breakdown */
    .breakdown {
      margin-bottom: 24px;
    }

    .breakdown-title {
      font-size: 13px;
      font-weight: 700;
      color: var(--accent-3);
      letter-spacing: 0.04em;
      margin-bottom: 12px;
      text-transform: uppercase;
    }

    .bd-row {
      display: grid;
      grid-template-columns: 110px 1fr 50px;
      gap: 10px;
      align-items: center;
      margin-bottom: 8px;
      font-size: 14px;
    }

    .bd-row strong {
      color: var(--ink);
      font-weight: 600;
    }

    .bd-track {
      height: 10px;
      background: #f0e8de;
      border-radius: 999px;
      overflow: hidden;
    }

    .bd-fill {
      display: block;
      height: 100%;
      border-radius: inherit;
      background: linear-gradient(90deg, var(--accent), #f5922e);
      width: 0%;
      transition: width 600ms ease;
    }

    /* Section Labels */
    .section-label {
      font-size: 13px;
      font-weight: 700;
      color: var(--accent-3);
      letter-spacing: 0.04em;
      margin: 24px 0 12px;
      text-transform: uppercase;
    }

    .mix {
      display: grid;
      gap: 9px;
    }

    .bar {
      display: grid;
      grid-template-columns: 120px 1fr 44px;
      align-items: center;
      gap: 10px;
      font-size: 14px;
    }

    .bar-track {
      height: 10px;
      background: #f0e8de;
      border-radius: 999px;
      overflow: hidden;
    }

    .bar-fill {
      display: block;
      height: 100%;
      border-radius: inherit;
      background: linear-gradient(90deg, var(--accent), #f5922e);
      width: 0%;
      transition: width 420ms ease;
    }

    /* Holdings Table */
    .holdings-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
      margin-top: 8px;
    }

    .holdings-table th {
      text-align: left;
      padding: 8px 10px;
      border-bottom: 2px solid var(--line);
      font-weight: 700;
      color: var(--accent-3);
      font-size: 12px;
    }

    .holdings-table td {
      padding: 8px 10px;
      border-bottom: 1px solid #f0ebe4;
    }

    .holdings-table tr:last-child td {
      border-bottom: none;
    }

    /* Insight Cards */
    .insight-block {
      margin-top: 20px;
    }

    .insight-block h3 {
      font-size: 15px;
      font-weight: 700;
      color: var(--accent-3);
      margin-bottom: 10px;
    }

    .insight-list {
      list-style: none;
      padding: 0;
    }

    .insight-list li {
      padding: 10px 14px;
      border: 1px solid #efe6da;
      border-radius: 12px;
      margin-bottom: 8px;
      font-size: 14px;
      line-height: 1.6;
      background: #fffcf8;
    }

    .insight-list li::before {
      margin-right: 8px;
    }

    .insight-list.summary li::before {
      content: "ğŸ“Š";
    }

    .insight-list.flags li::before {
      content: "âš ï¸";
    }

    .insight-list.checks li::before {
      content: "âœ…";
    }

    .term-card {
      border: 1px solid #efe6da;
      border-radius: 14px;
      padding: 16px;
      background: var(--accent-light);
      margin-top: 8px;
    }

    .term-card .tw {
      font-weight: 700;
      color: var(--accent);
      font-size: 15px;
      margin-bottom: 4px;
    }

    .term-card .td {
      font-size: 14px;
      color: var(--ink);
      line-height: 1.6;
    }

    .term-card .tw-imp {
      font-size: 13px;
      color: var(--muted);
      margin-top: 6px;
      line-height: 1.5;
    }

    /* Share Banner */
    .share-banner {
      margin-top: 24px;
      border: 2px dashed var(--accent);
      border-radius: 16px;
      padding: 16px;
      background: var(--accent-light);
      text-align: center;
    }

    .share-banner .share-text {
      font-size: 15px;
      font-weight: 700;
      color: var(--accent-3);
      line-height: 1.5;
      margin-bottom: 12px;
    }

    .actions {
      margin-top: 16px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
    }

    .footer-note {
      margin-top: 12px;
      font-size: 12px;
      color: #8a7a6e;
      line-height: 1.5;
      text-align: center;
    }

    @keyframes fadeUp {
      from {
        opacity: 0;
        transform: translateY(8px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    @media (max-width: 720px) {
      .wrap {
        margin: 24px auto 32px;
      }

      .hero {
        padding: 24px 22px 22px;
        border-radius: 22px;
      }

      .card {
        padding: 22px 18px;
        border-radius: 20px;
      }

      .top-row {
        flex-direction: column;
        align-items: flex-start;
      }

      .progress {
        width: 100%;
      }

      .bar {
        grid-template-columns: 95px 1fr 34px;
        font-size: 13px;
      }

      .holding-row {
        grid-template-columns: 1fr 1fr 36px;
        gap: 8px;
      }

      .bd-row {
        grid-template-columns: 90px 1fr 40px;
      }

      .radio-group {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<body>
  <main class="wrap">
    <section class="hero">
      <p class="eyebrow">MISO DAILY Â· SHARE TEST</p>
      <h1>ë‚´ í¬íŠ¸í´ë¦¬ì˜¤ë¡œ ë³´ëŠ”<br>íˆ¬ì ì„±í–¥ í…ŒìŠ¤íŠ¸</h1>
      <p>8ê°œ ì§ˆë¬¸ + ë‚´ í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ ì…ë ¥í•˜ë©´<br>ê±´ê°•ì ìˆ˜(0-100)ì™€ íˆ¬ì ìœ í˜•ì„ ë°”ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
    </section>

    <section class="card">
      <!-- í€´ì¦ˆ -->
      <div id="quiz">
        <div class="top-row">
          <div class="q-count" id="qCount">Q1 / 8</div>
          <div class="progress" aria-hidden="true"><span id="progressBar"></span></div>
        </div>
        <h2 class="question" id="question"></h2>
        <div class="options" id="options"></div>
      </div>

      <!-- í¬íŠ¸í´ë¦¬ì˜¤ ì…ë ¥ -->
      <div id="portfolio" class="portfolio-section">
        <h2>ë‚´ í¬íŠ¸í´ë¦¬ì˜¤ ì…ë ¥</h2>
        <p class="sub-desc">ë³´ìœ  ì¤‘ì¸ ì¢…ëª©ì˜ í‹°ì»¤ì™€ íˆ¬ì ê¸ˆì•¡ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.<br>ì˜ˆ) AAPL, NVDA, 005930 (ì‚¼ì„±ì „ì)</p>
        <div id="holdingsList">
          <div class="holding-row">
            <input type="text" placeholder="í‹°ì»¤ (ì˜ˆ: AAPL)" class="ticker-input">
            <input type="number" placeholder="ê¸ˆì•¡ (ì›)" class="amount-input">
            <button class="remove-btn" onclick="removeRow(this)" title="ì‚­ì œ">Ã—</button>
          </div>
          <div class="holding-row">
            <input type="text" placeholder="í‹°ì»¤ (ì˜ˆ: 005930)" class="ticker-input">
            <input type="number" placeholder="ê¸ˆì•¡ (ì›)" class="amount-input">
            <button class="remove-btn" onclick="removeRow(this)" title="ì‚­ì œ">Ã—</button>
          </div>
          <div class="holding-row">
            <input type="text" placeholder="í‹°ì»¤ (ì˜ˆ: NVDA)" class="ticker-input">
            <input type="number" placeholder="ê¸ˆì•¡ (ì›)" class="amount-input">
            <button class="remove-btn" onclick="removeRow(this)" title="ì‚­ì œ">Ã—</button>
          </div>
        </div>
        <button class="btn secondary" onclick="addRow()" style="margin-top:8px">+ ì¢…ëª© ì¶”ê°€</button>

        <!-- í˜„ê¸ˆ ë¹„ì¤‘ + ë§¤ë§¤ ë¹ˆë„ -->
        <div class="extra-section">
          <h3>ì¶”ê°€ ì •ë³´</h3>
          <div class="extra-input">
            <label>ğŸ’° ì „ì²´ íˆ¬ì ìì‚° ëŒ€ë¹„ í˜„ê¸ˆ(ì˜ˆìˆ˜ê¸ˆ) ë¹„ì¤‘</label>
            <input type="number" id="cashInput" placeholder="ì˜ˆ) 10 â†’ 10%" min="0" max="100" style="max-width:200px">
            <span style="font-size:13px;color:var(--muted);margin-left:4px">%</span>
          </div>
          <div class="extra-input">
            <label>ğŸ“ˆ í‰ê·  ë§¤ë§¤ ë¹ˆë„</label>
            <div class="radio-group" id="freqGroup">
              <label class="radio-option" onclick="selectFreq(this, 0)"><input type="radio" name="freq" value="0">ê±°ì˜
                ì—†ìŒ</label>
              <label class="radio-option" onclick="selectFreq(this, 1)"><input type="radio" name="freq" value="1">ì›”
                1~2íšŒ</label>
              <label class="radio-option" onclick="selectFreq(this, 2)"><input type="radio" name="freq" value="2">ì£¼
                1~2íšŒ</label>
              <label class="radio-option" onclick="selectFreq(this, 3)"><input type="radio" name="freq" value="3">ê±°ì˜
                ë§¤ì¼</label>
            </div>
          </div>
        </div>

        <div class="portfolio-actions">
          <button class="btn primary" id="analyzeBtn" onclick="submitPortfolio()">ë¶„ì„í•˜ê¸° â†’</button>
        </div>
      </div>

      <!-- ë¡œë”© -->
      <div id="loading" class="loading-overlay">
        <div class="spinner"></div>
        <p>í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤â€¦<br>ì„¹í„° ì¡°íšŒ ë° AI ì¸ì‚¬ì´íŠ¸ ìƒì„± ì¤‘</p>
      </div>

      <!-- ìµœì¢… ê²°ê³¼ -->
      <div id="result" class="result">
        <!-- ê±´ê°•ì ìˆ˜ ì›í˜• ê²Œì´ì§€ -->
        <div class="score-hero">
          <div class="label">í¬íŠ¸í´ë¦¬ì˜¤ ê±´ê°•ì ìˆ˜</div>
          <div class="gauge-wrap">
            <svg viewBox="0 0 160 160" width="160" height="160">
              <circle class="gauge-bg" cx="80" cy="80" r="70" />
              <circle class="gauge-fill" id="gaugeFill" cx="80" cy="80" r="70" />
            </svg>
            <div class="gauge-text"><span id="scoreNum">0</span><span>ì </span></div>
          </div>
          <div class="score-grade" id="scoreGrade">êµ¬ì¡° ê¸°ì¤€: ë¶„ì‚° Â· ì§‘ì¤‘ Â· í˜„ê¸ˆ Â· ê±°ë˜ìŠµê´€</div>
        </div>

        <!-- íˆ¬ì ìœ í˜• ì¹´ë“œ -->
        <div class="type-card" id="typeCard">
          <div class="type-label">ë‹¹ì‹ ì˜ íˆ¬ì ìœ í˜•</div>
          <div class="type-name" id="typeName"></div>
          <div class="type-oneliner" id="typeOneliner"></div>
          <div class="type-tags">
            <span class="type-tag strength" id="typeStrength"></span>
            <span class="type-tag caution" id="typeCaution"></span>
          </div>
        </div>

        <!-- ì ìˆ˜ ë¶„í•´ -->
        <div class="breakdown">
          <div class="breakdown-title">ğŸ“Š ì ìˆ˜ êµ¬ì„±</div>
          <div class="bd-row"><strong>ë¶„ì‚°</strong><span class="bd-track"><span class="bd-fill"
                id="bdDiv"></span></span><span id="bdDivTxt">0/35</span></div>
          <div class="bd-row"><strong>ì§‘ì¤‘ ë¦¬ìŠ¤í¬</strong><span class="bd-track"><span class="bd-fill"
                id="bdConc"></span></span><span id="bdConcTxt">0/30</span></div>
          <div class="bd-row"><strong>ìœ ë™ì„±</strong><span class="bd-track"><span class="bd-fill"
                id="bdLiq"></span></span><span id="bdLiqTxt">0/15</span></div>
          <div class="bd-row"><strong>ê±°ë˜ ìŠµê´€</strong><span class="bd-track"><span class="bd-fill"
                id="bdTrade"></span></span><span id="bdTradeTxt">0/20</span></div>
        </div>

        <!-- ë³´ìœ  ì¢…ëª© -->
        <div class="section-label">ğŸ“‹ ë³´ìœ  ì¢…ëª© ë¶„ì„</div>
        <table class="holdings-table" id="holdingsTable">
          <thead>
            <tr>
              <th>ì¢…ëª©</th>
              <th>í‹°ì»¤</th>
              <th>ë¹„ì¤‘</th>
              <th>ì„¹í„°</th>
            </tr>
          </thead>
          <tbody id="holdingsBody"></tbody>
        </table>

        <!-- ì„¹í„° ë¹„ì¤‘ -->
        <div class="section-label">ğŸ“Š ì„¹í„°ë³„ ë¹„ì¤‘</div>
        <div class="mix" id="sectorBars"></div>

        <!-- AI ì¸ì‚¬ì´íŠ¸ -->
        <div class="section-label">ğŸ¤– AI ì¸ì‚¬ì´íŠ¸</div>
        <div class="insight-block" id="insightBlock"></div>

        <!-- ê³µìœ  ë°°ë„ˆ -->
        <div class="share-banner">
          <div class="share-text" id="shareText"></div>
          <div class="actions">
            <button class="btn primary" id="shareBtn">ê²°ê³¼ ê³µìœ í•˜ê¸°</button>
            <button class="btn secondary" id="copyBtn">ë§í¬ ë³µì‚¬</button>
            <button class="btn secondary" id="restartBtn">ë‹¤ì‹œ í…ŒìŠ¤íŠ¸</button>
          </div>
        </div>
        <p class="footer-note" id="disclaimer">ì´ í˜ì´ì§€ëŠ” ì°¸ê³ ìš©ì´ë©° íˆ¬ì ê¶Œìœ ê°€ ì•„ë‹™ë‹ˆë‹¤.</p>
      </div>
    </section>
  </main>

  <script>
    const API_URL = "http://localhost:5001";

    /* â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” í€´ì¦ˆ ë°ì´í„° (A/B/C/D) â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” */
    const questions = [
      { q: "ìˆ˜ìµ/ë³€ë™ì„± ê´€ê³„ì—ì„œ ë‚´ê°€ ë” í¸í•œ ìª½ì€?", options: ["ìˆ˜ìµì´ ë‚®ì•„ë„ ë³€ë™ì´ ì‘ìœ¼ë©´ ì¢‹ë‹¤", "ì ë‹¹í•œ ë³€ë™ì€ ê°ìˆ˜í•˜ê³ , ì•ˆì •+ì„±ì¥ì„ ê°™ì´ ì›í•œë‹¤", "ë³€ë™ì´ í¬ë”ë¼ë„ ì„±ì¥ ê°€ëŠ¥ì„±ì´ ë” ì¤‘ìš”í•˜ë‹¤", "ë³€ë™ì´ ì»¤ë„ ìƒê´€ì—†ë‹¤. í° ìˆ˜ìµ ê¸°íšŒë¥¼ ë” ìš°ì„ í•œë‹¤"], keys: ["A", "B", "C", "D"] },
      { q: "íˆ¬ì íŒë‹¨ì—ì„œ ë‚´ê°€ ê°€ì¥ ì‹ ë¢°í•˜ëŠ” ê·¼ê±°ëŠ”?", options: ["ìˆ«ì/ì§€í‘œ/ë¦¬ì„œì¹˜(ê·¼ê±°ê°€ ëª…í™•í•œ ê²ƒ)", "ìˆ«ìë„ ë³´ë˜, ì‚°ì—…/ì œí’ˆ íë¦„ë„ ê°™ì´ ë³¸ë‹¤", "ë‰´ìŠ¤/ì´ë²¤íŠ¸/ì‹œì¥ ë¶„ìœ„ê¸°ì²˜ëŸ¼ \"í˜„ì¬ íë¦„\"ì„ ë” ë³¸ë‹¤", "ì§ê°/ìŠ¤í† ë¦¬/íŠ¸ë Œë“œ(ë‚´ëŸ¬í‹°ë¸Œ)ê°€ ë” í¬ê²Œ ì‘ë™í•œë‹¤"], keys: ["A", "B", "C", "D"] },
      { q: "ì¢…ëª©ì„ ê³ ë¥¼ ë•Œ ë‚´ ì ‘ê·¼ì€?", options: ["ê²€ì¦ëœ í° ê¸°ì—…/ëŒ€í‘œ ìì‚°ì´ ë§ˆìŒ í¸í•˜ë‹¤", "ìµìˆ™í•œ ì˜ì—­ì—ì„œ \"ê´œì°®ì•„ ë³´ì´ëŠ” í›„ë³´\"ë¥¼ ê³ ë¥¸ë‹¤", "ì„±ì¥ ì„¹í„°ì—ì„œ \"ìœ ë§í•œ í›„ë³´\"ë¥¼ ì°¾ëŠ”ë‹¤", "ë‚¨ë“¤ì´ ì•„ì§ ëœ ë³¸ ê¸°íšŒ(ì‹ ê·œ/ì†Œí˜•/í…Œë§ˆ)ë„ ì ê·¹ ì°¾ëŠ”ë‹¤"], keys: ["A", "B", "C", "D"] },
      { q: "ë³´ìœ  ê¸°ê°„(ìŠ¤íƒ€ì¼)ì€ ì–´ëŠ ìª½ì— ê°€ê¹ë‚˜?", options: ["ê¸¸ê²Œ ë“¤ê³  ê°€ëŠ” í¸(ë…„ ë‹¨ìœ„)", "ë¶„ê¸°~ë°˜ê¸° ë‹¨ìœ„ë¡œ ì ê²€í•˜ë©° ë“¤ê³  ê°„ë‹¤", "ê¸°íšŒê°€ ë³´ì´ë©´ ëª‡ ì£¼~ëª‡ ë‹¬ ë‹¨ìœ„ë¡œ ë°”ê¾¼ë‹¤", "íë¦„ì´ ë°”ë€Œë©´ ë¹ ë¥´ê²Œ ëŒ€ì‘í•œë‹¤(ì§§ì€ ì‚¬ì´í´)"], keys: ["A", "B", "C", "D"] },
      { q: "ë‚´ ë§¤ìˆ˜ íƒ€ì´ë°ì€ ë³´í†µ?", options: ["ê·œì¹™ì ìœ¼ë¡œ ë‚˜ëˆ ì„œ ì‚°ë‹¤(ë£¨í‹´í˜•)", "ì¡°ê±´(ê°€ê²©/ì§€í‘œ/ë‰´ìŠ¤)ì´ ë§ì„ ë•Œ ë“¤ì–´ê°„ë‹¤", "íë¦„ì´ ì¢‹ì•„ì§ˆ ë•Œ ë“¤ì–´ê°€ëŠ” í¸ì´ë‹¤(ì¶”ì„¸ í™•ì¸ í›„)", "ì´ìŠˆê°€ í„°ì§ˆ ë•Œ ê³¼ê°íˆ ë“¤ì–´ê°€ê¸°ë„ í•œë‹¤(ì´ë²¤íŠ¸í˜•)"], keys: ["A", "B", "C", "D"] },
      { q: "ìˆ˜ìµì´ ë‚¬ì„ ë•Œ ë‚˜ëŠ”?", options: ["ëª©í‘œì— ë„ë‹¬í•˜ë©´ ì¼ë¶€ë¼ë„ ì •ë¦¬í•˜ëŠ” ê²Œ í¸í•˜ë‹¤", "ì¼ë¶€ ì •ë¦¬ + ì¼ë¶€ ìœ ì§€(ì¤‘ê°„ ì¡°ì ˆ)", "ë” ê°ˆ ê²ƒ ê°™ìœ¼ë©´ ê¸¸ê²Œ ê°€ì ¸ê°€ê³  ì‹¶ë‹¤", "í™•ì‹  ìˆìœ¼ë©´ ì˜¤íˆë ¤ ë¹„ì¤‘ì„ ë” ì‹£ê¸°ë„ í•œë‹¤"], keys: ["A", "B", "C", "D"] },
      { q: "ì†ì‹¤ì´ ë‚¬ì„ ë•Œ ë‚˜ëŠ”?", options: ["ë¶ˆí¸í•´ì„œ ì¤„ì´ê±°ë‚˜ ì •ë¦¬í•˜ëŠ” í¸", "ë‹¤ì‹œ ì ê²€í•˜ê³ , ë‚©ë“ë˜ë©´ ìœ ì§€í•œë‹¤", "í™•ì‹ ì´ ìˆìœ¼ë©´ ì˜¤íˆë ¤ ë¶„í• ë¡œ ë” ì‚°ë‹¤", "ë°˜ë“±/ëª¨ë©˜í…€ì„ ë³´ê³  ë¹ ë¥´ê²Œ íŒë‹¨í•´ ê°ˆì•„íƒ„ë‹¤"], keys: ["A", "B", "C", "D"] },
      { q: "íˆ¬ìì—ì„œ ë‚´ê°€ ë” ì¤‘ìš”í•œ ê±´?", options: ["ì˜ˆì¸¡ ê°€ëŠ¥ì„±ê³¼ ë§ˆìŒì˜ ì•ˆì •", "ì¥ê¸°ì ìœ¼ë¡œ ê¾¸ì¤€íˆ ëª©í‘œ ë‹¬ì„±", "í° ê¸°íšŒë¥¼ ì¡ëŠ” ì„±ì¥ì„±", "ì‹œì¥ì˜ íë¦„ì„ ì½ê³  ë¹ ë¥´ê²Œ ê¸°íšŒ í¬ì°©"], keys: ["A", "B", "C", "D"] }
    ];

    /* â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 10ê°€ì§€ í˜ë¥´ì†Œë‚˜ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” */
    const TYPES = {
      "A+B": { name: "ì•ˆì •-ê´€ë¦¬í˜•", one: "í”ë“¤ë¦¼ ì¤„ì´ê³ , ê¾¸ì¤€íˆ ê´€ë¦¬í•˜ëŠ” íƒ€ì…", strength: "ğŸ›¡ï¸ ìŠ¤íŠ¸ë ˆìŠ¤ ë‚®ìŒ, ë£¨í‹´ ìœ ì§€ ê°•í•¨", point: "ğŸ“‰ 'ë„ˆë¬´ ë³´ìˆ˜ì ìœ¼ë¡œë§Œ' ê¸°íšŒê°€ ì¤„ ìˆ˜ ìˆìŒ" },
      "A+D": { name: "ì•ˆì •-ê¸°íšŒí˜•", one: "ì•ˆì •ì´ ê¸°ë³¸ì¸ë°, ê°€ë” í™•ì‹¤í•œ ì´ìŠˆì—” ë“¤ì–´ê°€ëŠ” íƒ€ì…", strength: "ğŸ¯ ë¦¬ìŠ¤í¬ ê°ê° ì¢‹ê³ , ì„ íƒì  ë² íŒ…", point: "âš¡ 'ê°€ë”'ì´ 'ìì£¼'ë¡œ ë°”ë€Œë©´ ìŠ¤íƒ€ì¼ ë¶•ê´´ ê°€ëŠ¥" },
      "A+C": { name: "ì•ˆì •-ì„±ì¥í˜•", one: "ë§ˆìŒì€ ì•ˆì •, ê´€ì‹¬ì€ ì„±ì¥ì— ìˆëŠ” íƒ€ì…", strength: "âš–ï¸ ê¸‰ë°œì§„ì€ ì ê³  ì„±ì¥ë„ í¬ê¸° ì•ˆ í•¨", point: "ğŸ¤” ì„±ì¥/ì•ˆì • ì‚¬ì´ì—ì„œ ê²°ì •ì„ ë¯¸ë£¨ê¸° ì‰¬ì›€" },
      "B+A": { name: "ê· í˜•-ì•ˆì •í˜•", one: "ì¤‘ê°„ê°’ì„ ì˜ ì°¾ëŠ” í˜„ì‹¤ì ì¸ íƒ€ì…", strength: "ğŸ§˜ ê³¼ì—´/ê³µí¬ì— ëœ íœ˜ë‘˜ë¦¼", point: "ğŸ˜ í™•ì‹ ì´ ìƒê²¨ë„ 'ë„ˆë¬´ ì¤‘ê°„'ë§Œ ê³ ìˆ˜í•  ìˆ˜ ìˆìŒ" },
      "B+C": { name: "ê· í˜•-ì„±ì¥í˜•", one: "ì„±ì¥ì€ ì¶”êµ¬í•˜ë˜, ê´€ë¦¬/ì¡°ì ˆì´ ìˆëŠ” íƒ€ì…", strength: "ğŸ’ª ì‹¤í–‰ë ¥+ì•ˆì •ê°ì˜ ê· í˜•", point: "ğŸ˜“ ì¡°ì ˆì´ ë§ì•„ì§€ë©´ ì˜ì‚¬ê²°ì • í”¼ë¡œê°€ ì˜¬ ìˆ˜ ìˆìŒ" },
      "B+D": { name: "ê· í˜•-ê¸°íšŒí˜•", one: "ìƒí™© ë§ì¶° ìœ ì—°í•˜ê²Œ ì›€ì§ì´ëŠ” íƒ€ì…", strength: "ğŸ”„ í™˜ê²½ ë³€í™”ì— ì ì‘ ë¹ ë¦„", point: "âš ï¸ ì›ì¹™ì´ íë ¤ì§€ë©´ 'ì¦‰í¥í˜•'ìœ¼ë¡œ ë³€ì§ˆ ê°€ëŠ¥" },
      "C+B": { name: "ì„±ì¥-ê´€ë¦¬í˜•", one: "ì„±ì¥ì— ë² íŒ…í•˜ë˜, ë£¨í‹´ê³¼ ë¦¬ìŠ¤í¬ë¥¼ ì±™ê¸°ëŠ” íƒ€ì…", strength: "ğŸ“ˆ ì¥ê¸°ì ìœ¼ë¡œ ê°•í•œ ì¡°í•©(ì„±ì¥+ê´€ë¦¬)", point: "ğŸ”¥ í™•ì‹ ì´ ê³¼í•´ì§€ë©´ 'ì§‘ì¤‘'ì´ ê³¼í•´ì§ˆ ìˆ˜ ìˆìŒ" },
      "C+D": { name: "ì„±ì¥-ê¸°íšŒí˜•", one: "ì„±ì¥ í…Œë§ˆì—ì„œ ê¸°íšŒê°€ ë³´ì´ë©´ ë¹ ë¥´ê²Œ íƒ„ë‹¤", strength: "ğŸš€ í° ì‚¬ì´í´/íŠ¸ë Œë“œ í¬ì°©ì— ê°•í•¨", point: "ğŸ’¸ ë§¤ë§¤ ë¹ˆë„ê°€ ë†’ì•„ì§€ë©´ ì²´ë ¥ ì†Œëª¨â†‘" },
      "D+B": { name: "ê¸°íšŒ-ê´€ë¦¬í˜•", one: "ê¸°íšŒë¥¼ ì°¾ë˜, ê·¸ë˜ë„ ê´€ë¦¬ì„ ì€ ì§€í‚¤ëŠ” íƒ€ì…", strength: "ğŸ¯ ë¯¼ì²©í•¨+ì œì–´ë ¥", point: "ğŸŒŠ ì‹œì¥ì´ ê³¼ì—´ë˜ë©´ ê´€ë¦¬ì„ ì´ ë¬´ë„ˆì§€ê¸° ì‰¬ì›€" },
      "D+C": { name: "ê¸°íšŒ-í™•ì‹ í˜•", one: "í™•ì‹ ì´ ì„œë©´ ë¹ ë¥´ê²Œ í¬ê²Œ ì›€ì§ì´ëŠ” íƒ€ì…", strength: "ğŸ’¥ ê°•í•œ ë“œë¼ì´ë¸Œ, ì„±ê³¼ê°€ ë‚  ë•Œ í­ë°œë ¥", point: "âš¡ ë¦¬ìŠ¤í¬ê°€ ì»¤ì§€ê¸° ì‰¬ìš°ë‹ˆ 'ìŠ¤ìŠ¤ë¡œ ë‚©ë“ ê°€ëŠ¥í•œ í•œë„'ê°€ ì¤‘ìš”" }
    };

    let current = 0, quizAnswers = [], selectedFreq = -1;

    const qCount = document.getElementById("qCount");
    const questionEl = document.getElementById("question");
    const optionsEl = document.getElementById("options");
    const progressBar = document.getElementById("progressBar");
    const quizEl = document.getElementById("quiz");
    const portfolioEl = document.getElementById("portfolio");
    const loadingEl = document.getElementById("loading");
    const resultEl = document.getElementById("result");

    /* â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” í€´ì¦ˆ ë Œë” â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” */
    function renderQuestion() {
      const item = questions[current];
      qCount.textContent = `Q${current + 1} / ${questions.length}`;
      questionEl.textContent = item.q;
      progressBar.style.width = `${(current / questions.length) * 100}%`;
      optionsEl.innerHTML = "";
      item.options.forEach((text, idx) => {
        const btn = document.createElement("button");
        btn.className = "option"; btn.type = "button"; btn.textContent = text;
        btn.addEventListener("click", () => {
          quizAnswers.push(item.keys[idx]); current++;
          if (current < questions.length) renderQuestion();
          else showPortfolioInput();
        });
        optionsEl.appendChild(btn);
      });
    }

    function showPortfolioInput() {
      progressBar.style.width = "100%";
      quizEl.style.display = "none";
      portfolioEl.style.display = "block";
    }

    /* â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” í¬íŠ¸í´ë¦¬ì˜¤ ì…ë ¥ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” */
    function addRow() {
      const list = document.getElementById("holdingsList");
      const row = document.createElement("div");
      row.className = "holding-row";
      row.innerHTML = `
        <input type="text" placeholder="í‹°ì»¤ (ì˜ˆ: TSLA)" class="ticker-input">
        <input type="number" placeholder="ê¸ˆì•¡ (ì›)" class="amount-input">
        <button class="remove-btn" onclick="removeRow(this)" title="ì‚­ì œ">Ã—</button>`;
      list.appendChild(row);
    }
    function removeRow(btn) {
      if (document.querySelectorAll(".holding-row").length > 1) btn.closest(".holding-row").remove();
    }
    function selectFreq(el, val) {
      document.querySelectorAll("#freqGroup .radio-option").forEach(o => o.classList.remove("selected"));
      el.classList.add("selected");
      selectedFreq = val;
    }

    /* â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” ê±´ê°•ì ìˆ˜ ê³„ì‚° â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” */
    function calcHealthScore(holdings, sectorExposure, cashRatio, tradeFreq) {
      const numStocks = holdings.length;
      const numSectors = Object.keys(sectorExposure).length;
      const top1Pct = holdings.length > 0 ? holdings[0].percentage : 0;

      // ë¶„ì‚° ì ìˆ˜ (35)
      let stockPts = numStocks >= 10 ? 35 : numStocks >= 5 ? 25 : numStocks >= 2 ? 10 : 0;
      let sectorPts = numSectors >= 4 ? 20 : numSectors >= 2 ? 10 : 0;
      const divScore = Math.min(stockPts + sectorPts, 35);

      // ì§‘ì¤‘ ë¦¬ìŠ¤í¬ (30)
      let concScore = top1Pct >= 70 ? 0 : top1Pct >= 40 ? 10 : top1Pct >= 20 ? 20 : 30;

      // ìœ ë™ì„± (15)
      let liqScore = cashRatio <= 3 ? 5 : cashRatio <= 10 ? 15 : cashRatio <= 25 ? 12 : 8;

      // ê±°ë˜ ìŠµê´€ (20)
      const tradeMap = [20, 15, 8, 0]; // ê±°ì˜ì—†ìŒ, ì›”1-2, ì£¼1-2, ë§¤ì¼
      let tradeScore = tradeMap[tradeFreq] ?? 15;

      return {
        total: divScore + concScore + liqScore + tradeScore,
        div: divScore, conc: concScore, liq: liqScore, trade: tradeScore,
        _numStocks: numStocks, _numSectors: numSectors, _top1Pct: top1Pct,
        _cashRatio: cashRatio, _tradeFreq: tradeFreq
      };
    }

    /* â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” í˜ë¥´ì†Œë‚˜ ë§¤í•‘ (A/B/C/D ì¹´ìš´íŠ¸ ê¸°ë°˜) â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” */
    function determineType(answers) {
      const counts = { A: 0, B: 0, C: 0, D: 0 };
      for (const a of answers) counts[a]++;

      const priority = { D: 4, C: 3, B: 2, A: 1 };
      const sorted = Object.keys(counts).sort((a, b) => {
        if (counts[b] !== counts[a]) return counts[b] - counts[a];
        return priority[b] - priority[a];
      });

      const key = `${sorted[0]}+${sorted[1]}`;
      return TYPES[key] || TYPES["B+C"];
    }

    /* â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” ì œì¶œ â†’ API â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” */
    async function submitPortfolio() {
      const tickers = document.querySelectorAll(".ticker-input");
      const amounts = document.querySelectorAll(".amount-input");
      const holdings = [];
      tickers.forEach((el, i) => {
        const t = el.value.trim(), a = parseFloat(amounts[i].value) || 0;
        if (t && a > 0) holdings.push({ ticker: t, amount: a });
      });

      if (holdings.length === 0) return alert("ìµœì†Œ 1ê°œ ì´ìƒì˜ ì¢…ëª©ê³¼ ê¸ˆì•¡ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.");
      const cashRatio = parseFloat(document.getElementById("cashInput").value) || 0;
      if (selectedFreq < 0) return alert("ë§¤ë§¤ ë¹ˆë„ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.");

      portfolioEl.style.display = "none";
      loadingEl.style.display = "block";

      try {
        const resp = await fetch(`${API_URL}/api/analyze`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            quizScore: quizTotal, quizType: "",
            holdings, cashRatio, tradeFrequency: selectedFreq
          }),
        });
        if (!resp.ok) { const err = await resp.json(); throw new Error(err.error || "ì„œë²„ ì˜¤ë¥˜"); }
        const data = await resp.json();
        showFinalResult(data, cashRatio, selectedFreq);
      } catch (e) {
        loadingEl.style.display = "none"; portfolioEl.style.display = "block";
        alert(`ë¶„ì„ ì‹¤íŒ¨: ${e.message}\n\nFlask ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•´ ì£¼ì„¸ìš”.\n(python3 app.py)`);
      }
    }

    /* â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” ê²°ê³¼ ë Œë” â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” */
    function showFinalResult(data, cashRatio, tradeFreq) {
      loadingEl.style.display = "none";
      resultEl.style.display = "block";

      const hs = calcHealthScore(data.holdings || [], data.sectorExposure || {}, cashRatio, tradeFreq);
      const type = determineType(quizAnswers);

      // â”€â”€ ê²Œì´ì§€ ì• ë‹ˆë©”ì´ì…˜ â”€â”€
      const circumference = 2 * Math.PI * 70; // â‰ˆ440
      const offset = circumference - (hs.total / 100) * circumference;
      const gaugeFill = document.getElementById("gaugeFill");
      gaugeFill.style.strokeDasharray = circumference;
      setTimeout(() => { gaugeFill.style.strokeDashoffset = offset; }, 100);

      // ì ìˆ˜ ìƒ‰ìƒ
      const scoreColor = hs.total >= 70 ? "#2d9a5c" : hs.total >= 40 ? "#d4a017" : "#c0392b";
      gaugeFill.style.stroke = scoreColor;

      document.getElementById("scoreNum").textContent = hs.total;

      // â”€â”€ íˆ¬ì ìœ í˜• ì¹´ë“œ â”€â”€
      document.getElementById("typeName").textContent = type.name;
      document.getElementById("typeOneliner").textContent = type.one;
      document.getElementById("typeStrength").textContent = type.strength;
      document.getElementById("typeCaution").textContent = type.point;

      // â”€â”€ ì ìˆ˜ ë¶„í•´ ë°” â”€â”€
      setTimeout(() => {
        document.getElementById("bdDiv").style.width = `${(hs.div / 35) * 100}%`;
        document.getElementById("bdConc").style.width = `${(hs.conc / 30) * 100}%`;
        document.getElementById("bdLiq").style.width = `${(hs.liq / 15) * 100}%`;
        document.getElementById("bdTrade").style.width = `${(hs.trade / 20) * 100}%`;
      }, 200);
      document.getElementById("bdDivTxt").textContent = `${hs.div}/35`;
      document.getElementById("bdConcTxt").textContent = `${hs.conc}/30`;
      document.getElementById("bdLiqTxt").textContent = `${hs.liq}/15`;
      document.getElementById("bdTradeTxt").textContent = `${hs.trade}/20`;

      // â”€â”€ ë³´ìœ  ì¢…ëª© í…Œì´ë¸” â”€â”€
      const tbody = document.getElementById("holdingsBody");
      tbody.innerHTML = "";
      (data.holdings || []).forEach(h => {
        const tr = document.createElement("tr");
        tr.innerHTML = `<td><strong>${h.name || h.ticker}</strong></td><td>${h.ticker}</td><td>${h.percentage}%</td><td>${h.sector}</td>`;
        tbody.appendChild(tr);
      });

      // â”€â”€ ì„¹í„° ë¹„ì¤‘ â”€â”€
      const sectorBars = document.getElementById("sectorBars");
      sectorBars.innerHTML = "";
      Object.entries(data.sectorExposure || {}).forEach(([label, value]) => {
        const r = Math.round(value * 10) / 10;
        const row = document.createElement("div"); row.className = "bar";
        row.innerHTML = `<strong>${label}</strong><span class="bar-track"><span class="bar-fill" style="width:${r}%"></span></span><span>${r}%</span>`;
        sectorBars.appendChild(row);
      });

      // â”€â”€ AI ì¸ì‚¬ì´íŠ¸ â”€â”€
      const insightBlock = document.getElementById("insightBlock");
      insightBlock.innerHTML = "";
      const insight = data.insight || {};
      if (insight.summary_3lines?.length) {
        insightBlock.innerHTML += `<h3>ğŸ’¡ ìš”ì•½</h3><ul class="insight-list summary">${insight.summary_3lines.map(s => `<li>${s}</li>`).join("")}</ul>`;
      }
      if (insight.red_flags?.length) {
        insightBlock.innerHTML += `<h3>ğŸš¨ ì£¼ì˜ ì‚¬í•­</h3><ul class="insight-list flags">${insight.red_flags.map(s => `<li>${s}</li>`).join("")}</ul>`;
      }
      if (insight.checklist?.length) {
        insightBlock.innerHTML += `<h3>ğŸ“ ì²´í¬ë¦¬ìŠ¤íŠ¸</h3><ul class="insight-list checks">${insight.checklist.map(s => `<li>${s}</li>`).join("")}</ul>`;
      }
      if (insight.term?.word) {
        insightBlock.innerHTML += `<h3>ğŸ“– ì•Œì•„ë‘ë©´ ì¢‹ì€ ìš©ì–´</h3><div class="term-card"><div class="tw">${insight.term.word}</div><div class="td">${insight.term.definition}</div><div class="tw-imp">${insight.term.why_important}</div></div>`;
      }
      if (insight.disclaimer) document.getElementById("disclaimer").textContent = insight.disclaimer;

      // â”€â”€ ê³µìœ  ë¬¸êµ¬ â”€â”€
      const shareMsg = `ë‚´ í¬íŠ¸í´ë¦¬ì˜¤ ${hs.total}ì  / ${type.name} ë‚˜ì˜´ã…‹ã…‹ ë„ˆë„ í•´ë´`;
      document.getElementById("shareText").textContent = `"${shareMsg}"`;

      // â”€â”€ ê³µìœ  ë²„íŠ¼ â”€â”€
      document.getElementById("shareBtn").onclick = async () => {
        const t = `[íˆ¬ì ì„±í–¥ í…ŒìŠ¤íŠ¸] ${hs.total}ì  Â· ${type.name}\n${type.one}\n${window.location.href}`;
        if (navigator.share) { try { await navigator.share({ title: "í¬íŠ¸í´ë¦¬ì˜¤ ê±´ê°•ì ìˆ˜", text: t }); } catch (_) { } }
        else copyText(t);
      };
      document.getElementById("copyBtn").onclick = () => copyText(`ë‚´ í¬íŠ¸í´ë¦¬ì˜¤ ${hs.total}ì  / ${type.name}\n${window.location.href}`);
    }

    /* â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” ìœ í‹¸ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” */
    function resetTest() {
      current = 0; quizTotal = 0; selectedFreq = -1;
      resultEl.style.display = "none"; portfolioEl.style.display = "none";
      loadingEl.style.display = "none"; quizEl.style.display = "block";
      document.querySelectorAll("#freqGroup .radio-option").forEach(o => o.classList.remove("selected"));
      document.getElementById("cashInput").value = "";
      const list = document.getElementById("holdingsList");
      list.innerHTML = `
        <div class="holding-row"><input type="text" placeholder="í‹°ì»¤ (ì˜ˆ: AAPL)" class="ticker-input"><input type="number" placeholder="ê¸ˆì•¡ (ì›)" class="amount-input"><button class="remove-btn" onclick="removeRow(this)" title="ì‚­ì œ">Ã—</button></div>
        <div class="holding-row"><input type="text" placeholder="í‹°ì»¤ (ì˜ˆ: 005930)" class="ticker-input"><input type="number" placeholder="ê¸ˆì•¡ (ì›)" class="amount-input"><button class="remove-btn" onclick="removeRow(this)" title="ì‚­ì œ">Ã—</button></div>
        <div class="holding-row"><input type="text" placeholder="í‹°ì»¤ (ì˜ˆ: NVDA)" class="ticker-input"><input type="number" placeholder="ê¸ˆì•¡ (ì›)" class="amount-input"><button class="remove-btn" onclick="removeRow(this)" title="ì‚­ì œ">Ã—</button></div>`;
      // reset gauge
      document.getElementById("gaugeFill").style.strokeDashoffset = 440;
      renderQuestion();
    }
    async function copyText(text) {
      try { await navigator.clipboard.writeText(text); alert("ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!"); } catch (_) { alert("ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."); }
    }

    document.getElementById("restartBtn").addEventListener("click", resetTest);
    renderQuestion();
  </script>
</body>

</html>